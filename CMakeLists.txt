cmake_minimum_required(VERSION 3.14)
project(Onegin)

set(CMAKE_CXX_COMPILER "/usr/bin/clang++" CACHE string "clang compiler" FORCE) #TODO check if clang is present when COVERAGE needed
                

set(CMAKE_CXX_STANDART 20)
set(CMAKE_CXX_STANDART_REQUIRED ON)


set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++20" CACHE STRING "Comment" FORCE)
set(CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS} -D NDEBUG" CACHE STRING "Comment" FORCE)
set(CMAKE_CXX_FLAGS_SANITIZER "${CMAKE_CXX_FLAGS} -Wpedantic -Wall -Wextra -Wformat=2 -fsanitize=address,undefined -g" CACHE STRING "Comment" FORCE)
set(CMAKE_CXX_FLAGS_COVERAGE "${CMAKE_CXX_FLAGS} -D NDEBUG -fprofile-instr-generate -fcoverage-mapping" CACHE STRING "Comment" FORCE)
set(CMAKE_CXX_FLAGS_DEBUG "${CMAKE_CXX_FLAGS} -g -Werror -Wall -Wextra -Weffc++ -Waggressive-loop-optimizations -Wc++0x-compat -Wc++11-compat -Wc++14-compat -Wcast-align -Wcast-qual -Wchar-subscripts -Wconditionally-supported -Wconversion -Wctor-dtor-privacy -Wempty-body -Wfloat-equal -Wformat-nonliteral -Wformat-security -Wformat-signedness -Wformat=2 -Winline -Wlarger-than=8192 -Wlogical-op -Wmissing-declarations -Wnon-virtual-dtor -Wopenmp-simd -Woverloaded-virtual -Wpacked -Wpointer-arith -Wredundant-decls -Wshadow -Wsign-conversion -Wsign-promo -Wstack-usage=8192 -Wstrict-null-sentinel -Wstrict-overflow=2 -Wsuggest-attribute=noreturn -Wsuggest-final-methods -Wsuggest-final-types -Wsuggest-override -Wswitch-default -Wswitch-enum -Wsync-nand -Wundef -Wunreachable-code -Wunused -Wuseless-cast -Wvariadic-macros -Wno-literal-suffix -Wno-missing-field-initializers -Wno-narrowing -Wno-old-style-cast -Wno-varargs -fcheck-new -fsized-deallocation -fstack-check -fstack-protector -fstrict-overflow -flto-odr-type-merging -fno-omit-frame-pointer -fPIE -fsanitize=address -fsanitize=alignment -fsanitize=bool -fsanitize=bounds -fsanitize=enum -fsanitize=float-cast-overflow -fsanitize=float-divide-by-zero -fsanitize=integer-divide-by-zero -fsanitize=leak -fsanitize=nonnull-attribute -fsanitize=null -fsanitize=object-size -fsanitize=return -fsanitize=returns-nonnull-attribute -fsanitize=shift -fsanitize=signed-integer-overflow -fsanitize=undefined -fsanitize=unreachable -fsanitize=vla-bound -fsanitize=vptr -lm -pie")

include(FetchContent)

FetchContent_Declare(
  googletest
  GIT_REPOSITORY https://github.com/google/googletest.git
  GIT_TAG        release-1.8.0
)

FetchContent_GetProperties(googletest)
if(NOT googletest_POPULATED)
  FetchContent_Populate(googletest)
  add_subdirectory(${googletest_SOURCE_DIR} ${googletest_BINARY_DIR})
endif()

include_directories(./include)

set_target_properties(gtest PROPERTIES FOLDER extern)
set_target_properties(gtest_main PROPERTIES FOLDER extern)
set_target_properties(gmock PROPERTIES FOLDER extern)
set_target_properties(gmock_main PROPERTIES FOLDER extern)

enable_testing()

add_executable(gsort src/onegin.cpp src/main.cpp src/gqsort.cpp)
add_executable(test-gqsort src/test-gqsort.cpp src/onegin.cpp src/gqsort.cpp)
add_executable(test-comp src/test-comp.cpp src/onegin.cpp src/gqsort.cpp)

target_link_libraries(
    test-comp
    gtest_main
)

target_link_libraries(
    test-gqsort
    gtest_main
)
include(GoogleTest)
gtest_discover_tests(test-gqsort)
gtest_discover_tests(test-comp)
 

message("                                                                                ,,,,,,,,,                                                                                            ")
message("                                                                  .a#      KKKKKKKKKKKK            KKNN##mmw,,,                                                                      ")
message("                                                                  ] KKKKKKKKKKKKKKKKKKKKKKKK              KKKK     BNp,                                                              ")
message("                                                                  ] KKKKKKKKKKKKKKKKKKKKKKKKK            KKKKKKKKKKKKK                                                               ")
message("                                                                  # KKKKKKKKKKKKKKKKKKKKKKKK              KKKKKKKKKKKK                                                               ")
message("                                                                  $ KKKKKKKKKKKKKKKKKKKKKKKK              KKKKKKKKKKKK N                                                             ")
message("                                                                  #KKKKKKKKKKKKKKKKKKKKKKKKK              KKKKKKKKKKKK M                                                             ")
message("                                                                   KKKKKKKKKKKKKKKKKKKKKKKKK                KKKKKKKKKK M                                                             ")
message("                                                                   KKKKKKKKKKKKKKKKKKKKKKKKK                 KKKKKKKKK L                                                             ")
message("                                                                 ! KKKKKKKKKKKKKKKKKKKKKKKKK               KKKKKKKKKKK                                                               ")
message("                                                                 ] KKKKKKKKKKKKKKKKKKKKKKKKK            K KKKKKKKKKKKK                                                               ")
message("                                                                 ] KKKKKKKKKKKKKKKKKKKKKKKKK               KKKKKKKKKKK                                                               ")
message("                                                                 1 KKKKKKKKKKKKKKKKKKKKKKKKK              KKKKKKKKKKKK                                                               ")
message("                                                                 # KKKKKKKKKKKKKKKKKKKKKKKKK            KKKKKKKKKKKKKK                                                               ")
message("                                                                   KKKKKKKKKKKKKKKKKKKKKKKKK           KKKKKKKKKKKKKKK                                                               ")
message("                                                                ] KKKKKKKKKKKKKKKKKKKKKKKKKK      KKKKKKKKKKKKKKKKKKKK                                                               ")
message("                                                                  KKKKKKKKKKKKKKKKKKKKKKKKKKKKK      KK KKKKKKKKKKKKKK                                                               ")
message("                                                               j  KKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKK     @                                                             ")
message("                                                            ,,w# KKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKK    @                                                             ")
message("                                                     ,,w#  KKKK KKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKK  @                                                             ")
message("                                                 ,z#           KKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKK N,,,,,                                                        ")
message("                                                j    BK KKKBKK  KKKKKKKKKKKKKKKKKKKKKKKKKKKK                 B     BKKKBKKKDDPPDKpp                                                  ")
message("                                                \" KKKKKKKKKKKKK                                                        KKKBE*\"\"\"\"\"`                                                  ")
message("                                                 ,w#KKKKK KB                    B  DKKPPPh0KPPPKKbEhKKKKB     KNDK    K KKKBNm,                                                      ")
message("                                            ,w#pK$KUKhKhKhKhbhhKhKKKhbKKKbKKbhKUK0KKhKKPhKKhbKbKhKKhKbKKhB KK     NP K KKDKKKBKm                                                     ")
message("                                      ,p#KKDKKKUKhKKhKKKbPKbKKbhKh#DK#KKDU#KKKKKKKKKKKKhKhhKhhKbbKKKDh#KKK0     K  KUBKKKKBKDK  mn                                                   ")
message("                                 ;#K#KKKP$KKPbPhbKKUKbPhKhhKbUKD#KKKD##KKKKKKKKKBKKKKKKKhKhUhbhKbhKKbKKKKUK# KKK K B K KKK KKDKKBN@                                                  ")
message("                             ,w#KBKKhhhbKPUhbhbKhKKbPhbbhhPhKKK0KKKKKKKUhpKhhhhbKKBKKKKKKKhKhKKKKKKbPKKKKKK#KKK  KU#KK  KKKKKbKKKKKNp                                                ")
message("                         ,,#KPKbhbP$hbKKKhhKbKbbbhKbbbbbKKb#K#KKK  KbbEppp2|||pQKBKKKKKKKKKKKb0bbhhbhbbbbhK KKK  bB      KK KKKKKBKKKK,                                              ")
message("                      ,p#KKKKKbPK$KbhPPUKKhKKbhhKKhKKhKKKhKUKKK K  KKKK          KKKKKKKKKKKKUP0KKKbP0bKbhbK               KKKKKDKKKDKp                                              ")
message("                    ,#KKKKKKbKPhmh0KhKhKhbKhhKhKbhKbbPPbhKhPKKD    KKKKKKKK KK BEU#  KKbbKPbKKhhbhbbhK#bhPhh#    KK            KKKKDKKKH,                                            ")
message("                 ,# KKKKKKKhKKKKhKKPbKKKKbbhKhKUKbhbhhKhbPKKbKKKP            BP#KK KKKKKbPh0PhhhKhhbKKhmDDKWhKKK B    KKKKKKKB KKB KBKKKN                                            ")
message("               y# BKBKKKKKKbKhKpPhhPbhbhKKKKKKKKKKKbhKhhPKbKbKKKBKUPPKKKEPbKKK K KKKhbbhKhQSPPKKbKhUhKKKbbPTbK0KKKKKKKKDKKBKKKKK0KKKKDKKKKp                                          ")
message("              ]KKK    KBBKKPKKKhKhbPUKKKKKKKKbKbbpKbKKKKKKbKbhKKPKKDBBKBBKBKKKKKKKKKbbKhpKKWpKbhhEbUPPbbpbhKhbhbKPKKKKKKKDKKKKKKKKKKKKBKKBBN                                         ")
message("             ] K         KBKKKKhKKKhbKhKbKKKPKKphhKhbbPPbhKKKKKpPhPhhbKKKbUKpbKphhbhKUKKbKbbKpbbKhbKKDKKUBKKKKUPhKbKhKKKKKKKKKKKKKKKKKKKKBNXC\                                       ")
message("            ,KKKB       KKKKKKKKbbKKKKbKKbbKKKKKbKbPhbhhKKPKhbKKpPKhDKKKKhKbKPKhbPhhPbPKKppPKKKhbKKKbKNp$KKUPKpPKhbPKPKKKKKKKKKKKKKKKKKKKKKKm*                                       ")
message("            ]KK   D    K KKKKKKKKKhKbKhbKKbhKbKKK0KbKhKKKKKKBKhbhPPhbhhKUbKhKKKhP0PhbP$KhKKbKKKQKKN@KPKNpPK@KKphPKbbUhKKKbPKKKKKKPKKKKKKKKKD Bp                                      ")
message("            ]K KBK 8   KBKKKKKKKKbKKKKbKKKKKKbhKKhPKKhbhhKKKK0KKKKhKbKKbKKKbbPbKbbhKhpbKKUbPKKBKUKKmBKEK0KNpBN50KKpKbKNpKbKbKBKKUKKKKKKKBKKBK JW                                     ")
message("            $   KE K KBB KKKKhKKbKbKKbhKhKKKKbKbKKKKhhUbKKbKKhbKKKhKK0KQKbKKKDKKKbKPbKhPbbpPKKbKKhKKKBKEKpKbKKpKmKKQKpPPKhhpKKK0KBNKKKKKKK0KK KKw                                    ")
message("            $    KK  KKDKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKhKKbKKhKKKbKKD0bKKPDKKKKKppKKKbKKKPKKhKKKmKbKKKbhIKKKPN@hhKUh0KKKKbKKKKbKPKNhKhD KBBp                                    ")
message("            ]  KKKK     KKKDKKKKKKKKKKKKKKKK B      K   B KKKKKKKKKKKKppKKKKKKKKWDKKKmbPbh2KhbKKKN2KUKKbhKh0hhKKKphKKpKpIPhhKpbhKKUNbPKKKmK#     H                                   ")
message("             8 KKK    K KKKKKKKKKKKKKKKKBKKKBB           BKK  KBK K KKKbKKKKbKKKDKKBKDb2KKbPKKKKbhPKKDKDKNBKbbKhpPKbPPhQKhp$0Kbh0KPKNKpKBK   KK B]                                   ")
message("            '<8 KK    B KK#KKKKDKKKKKKB KK KKK  KBBKKKKKKBKKB KKKKKKKKKBKKBKKKKKKKKKKKKKKmhhKpKKKKKKKKKKbKKK0UbhEKb0hPhhKpKKK0Khb0pKI  K    K  \"] Kp                                 ")
message("              T  K     KKBKKKKKDKKKKKKKB KKKKKKKKKKKKKKKKKKKKKKBKKKKKKKKKKKKKKKKKKKKKKKKKKKKKPKNAKKKKKKKKK0KKKp0KhPKm0KKphDbKbKKKKbKKK KK K  M \#KKK p                                ")
message("              |K        BBKKKKKKKKKKKKKKKKKBKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKBKKKKpKKpPKKKKDKKKKKKbKKNKp@K0KphKKKKBKKKDB   KKK   B`z KKKKKKm                               ")
message("              `!K      KKKKKKKKKKKKKDKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKBKKKKKKKKKKKKKKKUPKKKKKUKKKKbQKN@KKbK#KBKKKKD  KKK   M`,#KKKKKKKKKL                              ")
message("                *    KK  KBKK KBKKKKKKQKKKKKKQKKKKKKK0KKKKbKK#KKUbKKKKKKKKKKKKKKKKKKKKKKKKKKKhU0KKKDbKhhKKKUhKKKUPhI  2NKP  ND  KK KK  M  # KKKKKKKKKK p                             ")
message("                 ]         B B K KKKK0KKKKKKDKKKKKKKKKKKKKKKBK  K KKKKKKKKNKKKKKKKKKKKKKKK#bKpKKKpKUhKKKKKbKKKKKK pKD8   DP KKKK     M ,# KKKKKKKKKKK K p                            ")
message("                /`IB               KKKKK BBK KBK KKKKKKBKK K BKKKB KKKKKKK  KDK KKKKKKKKKKKKKKKKKKKKKKKBKKB@hK KKb DKKD     KK     * ,# KKKKKKKKKKKKKKKKKm                           ")
message("               '  \"`M   BK                      KK D B    B    KKDBKBKKK KKB   KBK KKKBKKKKKKKKKKKKKKKKKKK   mKB BK B   KKKK   KKC ,# KKK  KKKKKKKKKKKKKKK                           ")
message("                     ``\"*KKB  B    B                             B   B          KK   K K  KKKKBKKKKKKKKKKK BK  @K  p  KKKK    K\" ,#  KKKK  KKKKKKKK KKKKKKKKm                        ")
message("                          ' YK            KKK    K K  K K                                KK  KKB KK K K KBKKK#B BB  KKKKK  DM``,B  KKKK   KKKKKKKK KKKKKKKKKK                        ")
message("                             `YKBB           K KKKKKKKKKKKKKKKK  KKKKK                     KKKKBBBKD0KKKKKBKKK K   KKKK   M` ,B   KKKKK KKKKKKKKK KKKKKKKKK KKKm                     ")
message("                                 *` ````\"*````'T MPM       KKKKKKKKKKKKKKKKKKKK         B  KKKKKBKBKKKKKK KK D KKKK     C  z  KKKKKK KKKKKKKKKKK KKKKKKKKKKKKKKK p                   ")
message("                                                       `   `K"'"PPTMK  KKKKKKKKKK           B KBKKKKKKU#BK   K KKK  BK\"  a    KKKKKKK K KKKKKKK KKKKKKKKKKKKKKKKKK ,                 ")
message("                                                                      `* KKKKKKKKKK         B KKKBK K mN KKKKK K   M`  a KKKKKKKKKKKKKKKKKKKKK KKKKKKKKKKKKKKKKKKKKK                 ")
message("                                                                          KKKKKKKKKK K        KKKKK  #K KKKK    K^  ,#  KKKKKKKKKKKKKKKKKKKKK KKKKKKKKKKK KKKKKKKKKKKKm              ")
message("                                                                         !BKKKKKKKKKKKK         DKK  KKKKK    M*  ,#  K KKKKKKKK KKKKKKKKKKK KKKKKKKKKKKKKKKKKKKKKKKKKK p            ")
message("                                                                          T KKKKKKKKKK              KK      C   ,#KK   KKKKKKKKKKKKKKKKKKKK KKKKKKKKKKKKKKKKKKKKKKKKKKKKKm           ")
message("                                                                        ,,]KKKKKKKKK             KKK    KM^   ,BKKKKK   K KKKKKKKKKKKKKKKK KKKKKKKKKKKKKKKKKK KKKKKKKKKKK            ")
message("                                                                      z        KKKK          KK KK    Ml    a KKKKKKK    KKKKKKKKKKKKKKKK KKKKKKKKKKKKKKKK KK KK K  KKKKK            ")
message("                                                                    a   KKKKKK         KKKKKKK     M*    ,# KKKKKKKKKK    K KKKKKKKKKK K KKKKKKKKKKKKKKK     KKK KKKKKKKK            ")
message("                                                                ,g     KKKK K        KKKKKK    KM*     ,# KKKKKKKKKKKK   K KKKKKKKKKKKK KKKKKKKKKKKKKKK      KK KKKKKKKKKM           ")
message("                                                            ,a  K     KKKKKK        KKKK BM5L+*`     a  KKKKKKKKKKKKKK   K K  KKK  KKK KKKKKKKKKKKKK         KK  KKKKKKKKM           ")
message("                                                          z    K     KKKK          KKK M:L|*`      a  KKKKKKKKKKKKKKKKK       KKKKKKK KKKKKKKKKKKKK K          KK  KKKKKK            ")
message("                                                       ,#   K F    BBKKB         KK MP*2'`      ,a  KKKKKKKKKKKKKKKKKKK KKKKKKK    K KKKKKKKKKK KK KK       KK    K KKKK             ")
message("                                                      ]   KM` ,    KKKK        KKK Lm*`       ,#  KKKKKKKKKKKKKKKKKKKKK KKKKKKKKKKKKKKKKKKKKK KKKKKKK      KK K K  KKKKKM            ")
message("                                                       KK     #    KK#        KKK P`        ,#   KKKKKKKKKKKKKKKKKKKKKK KKKKKK KKKKKKKKKKKKKK   KK                KK KK              ")
message("                                                     ]KK      #  BKKKB       KK ^         ,#  KKKKKKKKKKKKKKKKK KKKKKKK BKKKK      KKKKKKKKK  KKKK           KKKK KKKK M             ")
message("                                                   ,#KKM     ]  BKK#BK       M           ] K KKKKKKKKKKKKKKKKK K KKKKKK  KKKKKKKKKKKKKKKKK    K K K         KKKKKKKKK M              ")
message("                                                  , K ` ,#BN;   KKKKKK    KM           #    KKKKKKK  KKKKKKKKKK K KKKKK  KK KKKKKKKKKKKKKKK  K KK    KK KKKKKKKKKK R'                ")
message("                                                 ]KK  mKQIP                L#KN,     a KKKKKKKKKKKK KK KKKKKKKKK K KKKK  KKKKKKKKKKKKKKKKK   KKK KKKKKKKKKKKKK   ^                   ")
message("                                                jKKD*`|Ih$    BK        KK MT*|LY  , KKKKKKKKKKK   KKKK KKKKKKKKKK KKK   KKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKK \"                      ")
message("                                               j KH  ||$    KKKK        KKM '`'  $ KKK KKKKK KKKKKKKKK  K KKKKKKKKK   KKKKKKKKKKKKKKKKKK  KKKKKKKKKKKKKKKKK KaK`                     ")
message("                                              ]  H |*,     KKKK        KKP    *z KKK KKK KKKKKKKKKKK KKKK KKKKKK   KKKKKKKKKKKKKKKKKKKKKKKKK KKKKKKKKKKKK K F                        ")
message("                                                K `,#     KK K        KKL *`<y       KKKK KKKKKKKKKKKKKKKKKK   KKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKK KK F                           ")
message("                                               KM'j   B B  KK        KKM   y K   KK  K    KKKKKKKK KKKKK    KKKKKKKKKKKK  KKKKKKKKKKKKKKKKKKKKKKKKKKK M                              ")
message("                                            !K BLj   B   KK         KKKL'a K K  KKKKK KKKKKKKKKKKKKK    KKKKKKKKKKKKK  K    KKKKKKKKKKKKKKKKKKK KK M`                                ")
message("                                            ]  B ]     KKK K  B    KKK , K KK KKKKKKK  K KKKKKKK    KKKKKKKKKKKKKKK  KK    KKKKKKKKKKKKKKKK   K R`                                   ")
message("                                            ]  K ]    KKKK K      KK K K   KKKKKKK    KK  KKK   KKKKKKKKKKKKKKKKKKKKKK    KKKKKKKKKKKKKKK    M\"                                      ")
message("                                            !K B !   KKKKKB         KKKKKK  KKKKK           KKKKKKKKKKKKKKKKKKKK    K  K  KKKKKKKKKKK     M`                                         ")
message("                                            '  BL #  K KKKK       KK    K KKKKKK K KK   KKKKKKKKKKKKKKKKKKKKKKK KKK  K KK   KKKKKK    M*`                                            ")
message("                                                H ]     KK       KK KK KKKKKKKKKKK   KKKKKKKKKKKK              KKKKKKK   KK KKK  KKM`                                                ")
message("                                             1    1    KKK      K   KKKKKKKKKK   KKKKKKKKKKKKK  KKBKB           KKKKKK   KKK M` `                                                    ")
message("                                             !          B K   K  KKKKKKKKKK  KKKKKKKKKKKKKKKK K               K KKKKK KKK M`               ,`                                        ")
message("                                                K]K     KKK   K   KKKKK   KKKKKKKKKKKKKKKKKK                 KK KKKKKK M`                 ,`,,   w,.   , ,                           ")
message("                                              1            K     KKK   KKKKKKKKKKKKKK KKKKKKKKKKKKKKK   KKKKKK KKKK M`                    ```\"``'```\"`\"`.                            ")
message("                                               4 K             KK   KKKKKKKKKKKKKK K    K KKKK KKKKKKKKKKKKKKKK R*                                                                   ")
message("                                                ?           KK   KKKKKKKKKKKKKKKKK  KKKK KKKK      K KKK     F`                                                                      ")
message("                                                 'K       K  KKKKKKKKKKKKKKKK KKK  KKK                  MF`                                                                          ")
message("                                                  \"       KKKKKKKKKKK                        MM*^`````                                                                               ")
message("                                                   \"                         MM\"`!MKBKMM*`                                                                                           ")
message("                                                     `\"f\"`\"`````` \"``\"\"```                                                                                                           ")
message("                                                                                                                                                                                     ")
message("\t\t\t\t\t\t\t\t\t  ---------------------------------")
message("\t\t\t\t\t\t\t\t\t  |  Thx for checking out my lab! |")
message("\t\t\t\t\t\t\t\t\t  ---------------------------------")
message("                                                                                                                                                                                                   ")
message("                                                                                                                                                                                                   ")
